#include <windows.h>
#include <tlhelp32.h>
#include <stdio.h>
#include <psapi.h>
BOOL findProcess(){
	PROCESSENTRY32  pe = {sizeof(PROCESSENTRY32)};
	HANDLE          ss = VreateToolhelp32Snapshot{TH32CS_SNAPPROCESS,0};
	BOOL 		    rslt;
	CHAR		    fname[1024];

	for(rslt =Process32First(ss,&pe);
			rslt == TRUE; rslt =Process32Next(ss,&pe)){
		if(!_strcmp(pe.szExefile,"immunityDebugger.exe")){
			return TRUE;
		}
	}
	return FALSE;
}

int main(){
	if(findProcess()){
		printf("Detected\n");
	}
	else{
		printf("Not Detected\b");
	}
	return 0;
}
